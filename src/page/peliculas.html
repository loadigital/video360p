
<script>
    let url_vlr = new URL(document.location).searchParams;
    let cal = url_vlr.get('cal');
    let v_id = url_vlr.get('v_id');
    let server = url_vlr.get('server');
    let id = url_vlr.get('id')
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="../../img/icono.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#242424">
    <title id="titulo"></title>
    <link rel="stylesheet" href="../../css/libreria-1-0-1.css">
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="https://loadigital.github.io/movies.biloa/icon/bootstrap-icons.css">
    <script src="https://loadigital.github.io/movies.biloa/js/jquery.js"></script>
    

    <script src="../../js/api.js"></script>
   
    <style>
        #container{display: none;}
        .co-link{width: 100%;height: auto;display: flex;flex-direction: row;flex-wrap: wrap;justify-content: center;}
        .co-link a{ width: 100%;height: auto;display: flex;flex-direction: row;flex-wrap: wrap;justify-content: center;margin: 7px;text-decoration:none;}
        .bot-1{background:#dc7612;padding: 7px;border-radius: 5px 5px;font-family: Arial;border: none;}
        .bi-cloud-arrow-down, .bi-play-circle {font-size: 20px;color:#fff;}
        .co-link p{margin-top: 10px;text-align:justify;}
        
        #ver{background:#000;}
        
        
</style>
</head>
<body >
<div id="loading"></div>
<div id="include-header"></div>
<main id="main--">
<section style="padding: 0px;" id="section-class" class="section-class col-12 flexrow-c" >
<div class="contenedor-video col-12 flexrow-c" id="video--">
        
    <div class="contenedor-iframe col-12 flexrow-c" style="align-items: flex-start;">
            
        <iframe id="ver" src="" frameborder=0 marginwidth=0 marginheight=0 scrolling=no width=720 height=460 allowfullscreen allow="autoplay" ></iframe>
    </div>
    
    <div class="co-link">
	   		<a id="descarga" target="_blank" href=""><button id="cali--" class="bot-1 bi-cloud-arrow-down"><script>document.getElementById("cali--").innerHTML = ` Descargar - ${cal}`</script>  </button></a>
	
            <div class="anuncios"></div>
    </div>
    
    
    
 </div>
 <div class="anuncios col-12 flexrow-c"></div>
    <div class="similares-title col-12 flexrow-de"><p class="colore">Recomendadas de Video 360p:</p></div>
    
    <div class="cards-similares grid-2 col-12 flexrow-c" id="cards-similares"></div>
    
    <div class="anuncios"></div>
 

    <div class="col-12 flexrow-c" style="padding: 0px;">
        
    </div>
    <div class="col-12" id="footer"></div> 
</section>

</main>

<script>

let idAPI = url_vlr.get('id');
var img_fondo;

const video = document.getElementById("video--");

const  API_URL  =  BASE_URL  +  '/movie/' + idAPI + '?' + API_KEY + '&language=es-ES';//CODIGO TMBD

getMovie(API_URL);

function getMovie(url){
    fetch(url).then(res => res.json()).then(data =>{
        console.log(data)
        pintar(data);
    });
};

function pintar(data){
     img_fondo = IMG_URL + data.backdrop_path;
    function calHora(minutos){
        let horas = Math.floor(minutos / 60);
        let minutosRes = minutos % 60;
        return {horas, minutos: minutosRes};
    };
   let x = calHora(data.runtime);

   document.querySelector("#titulo").innerHTML = data.title;
    
   const resumen = document.createElement("div");
    
    resumen.innerHTML = `
    <style>
     #section-class{
      background: linear-gradient(rgba(0,0,0,0.2) 0%,rgb(0, 0, 0) 100%),
      url('${IMG_URL + data.backdrop_path}');
      background-repeat: no-repeat;
      background-size: 100%;
      height: 40.62em;
      align-items: flex-start;
        }
    @media screen and (max-width:800px ) {
    #section-class{
        height: 15.62em;
    }
    }
    </style>
        <div class="contenedor-title-video col-12 flexrow-c">
            <div class="title-video col-12"><p>${data.title}</p></div>
        </div>
        <div class="col-12 flexrow-c">
            <div class="puntuacion-genres col-12 flexrow-c">
                <i class="bi-star-fill"></i><i class="bi-star-half"></i><i class="bi-star"></i>
                <p>${data.vote_average.toFixed(1)}</p><div class="col-12 flexrow-de" id="divGenres"><p class="colore">Genero: </p></div></div>
                <div class="puntuacion-genres col-12 flexrow-c"><p class="colore">Estreno: </p><p>${data.release_date} <p class="colore">Duraci√≥n: </p> ${x.horas}h ${x.minutos}m</p></div>
        </div>
        <div class="descripcion-video col-12 flexrow-de">
            <p class="colore-">${data.overview}</p>
        </div>
        
     `
     video.appendChild(resumen)
    const divGenres = document.getElementById("divGenres")
     data.genres.forEach(genres =>{
        
    const _pgenres = document.createElement("p");
    _pgenres.className="_pgenres"
    _pgenres.innerHTML = `${genres.name},`
        divGenres.appendChild(_pgenres);
        
    });
}


document.addEventListener('DOMContentLoaded', () => {
        fetchData();
    });
    
    const fetchData = async () => {
       try{
           const res = await fetch('../../js/movies.json');
           const data = await res.json();
           pintarPagePeliculas(data);
       }catch (error) {
           console.log(error);
       }
    }
    const pintarPagePeliculas = data => {
    
    
const similares = document.getElementById("cards-similares");
const newArrayNew =  data.slice(0, 4);
    newArrayNew.forEach(element => {

    const  API_URL_R  =  BASE_URL  +  '/movie/' + element.id + '?' + API_KEY + '&language=es-ES';//CODIGO TMBD


  getMovier(API_URL_R);

function getMovier(url){
    fetch(url).then(res => res.json()).then(data =>{
        console.log(data)
        pintar(data);
    });
};

function pintar(data){

   
        const card = document.createElement("div");
        
        card.innerHTML += `
        <div class="card">
            <div class="card-img">
                <a href="${linkMovies + element.id + '&v_id=' + element.video + '&cal=' + element.calidad}"><img class="img-card" src="${IMG_URL + data.poster_path}" alt=""></a>
            </div>
            <div class="card-body">
           
            <div class="title-card"><h1>${element.title}</h1></div>
            
            </div>
        </div> 
        `
        similares.appendChild(card)
    
}    
}) 
data.forEach(element =>{

if (element.id == id) {

if (element.externo != "0" && element.externo != "" ) {
    document.getElementById("ver").src = element.externo;
    document.getElementById("descarga").href = "http://video360p.byethost4.com/descarga.php?id=" +  element.video + '&t=' + element.title;
}else if (cal === "null" || cal === "nulls") {
    document.getElementById("ver").src = "https://loadigital.github.io/movies.biloa/archivo%20no%20disponible.html";
    document.getElementById("descarga").href = "https://loadigital.github.io/movies.biloa/archivo%20no%20disponible.html";
}else{

    document.getElementById("ver").src = "https://loadigital.github.io/movies.biloa/ok.stream.html?id=" + v_id;
    document.getElementById("descarga").href = "http://video360p.byethost4.com/descarga.php?id=" +  element.video + '&t=' + element.title;
    
}

}
})

}

</script>
<script type="module" src="../../js/main.js"></script>
<script type="module" src="../../js/libreria-1-0-1.js"></script>

<div id="scalar"></div>
</body>
</html>

